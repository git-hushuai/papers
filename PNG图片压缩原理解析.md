### 什么是PNG

----

PNG的全称是便携式网络图型（Portable Network Graphics）是目前最流行的网络传输和展示的图片格式，原因有如下几点：

+ 无损压缩：PNG图片采取了基于LZ77派生算法对文件进行压缩，使得它压缩比率更高，生成的文件体积更小，并且不损失数据。

+ 体积小：它利用特殊的编码方法标记重复出现的数据，使得同样格式的图片，PNG图片文件的体积更小，网络通讯中因受带宽制约，在保证图片清晰、逼真的前提下，优先选择PNG格式的图片；、

+ 支持透明效果：PNG支持对原图像定义256个透明图层，使得图像的边缘能与任何背景平滑融合，这种功能是GIF和JPEG没有的；


### PNG 类型
---

PNG图片主要有三个类型，分别为 PNG 8/ PNG 24 / PNG 32。


+ __PNG 8：__PNG 8中的8，其实指的是8bits，相当于用2^8（2的8次方）大小来存储一张图片的颜色种类，2^8等于256，也就是说PNG 8能存储256种颜色，一张图片如果颜色种类很少，将它设置成PNG 8得图片类型是非常适合的。

+ __PNG 24：__PNG 24中的24，相当于3乘以8 等于 24，就是用三个8bits分别去表示 R（红）、G（绿）、B（蓝）。R(0~255),G(0~255),B(0~255)，可以表达256乘以256乘以256=16777216种颜色的图片，这样PNG 24就能比PNG 8表示色彩更丰富的图片。但是所占用的空间相对就更大了。


+ __PNG 32：__PNG 32中的32，相当于PNG 24 加上 8bits的透明颜色通道，就相当于R（红）、G（绿）、B（蓝）、A（透明）。R(0~255),G(0~255),B(0~255),A(0~255)。比PNG 24多了一个A（透明），也就是说PNG 32能表示跟PNG 24一样多的色彩，并且还支持256种透明的颜色，能表示更加丰富的图片颜色类型。


#### PNG图片数据结构

---
![](https://user-gold-cdn.xitu.io/2019/3/17/1698be9854359e46?imageView2/0/w/1280/h/960/ignore-error/1)

#### 使用sublime 编码模式打开PNG图片，回事下面这个样子

```
8950 4e47 0d0a 1a0a 0000 000d 4948 4452
0000 0140 0000 0100 0806 0000 00c2 c8af
c600 0020 0049 4441 5478 5eec bd09 b4a5
d759 1db8 ffff cec3 9be7 a154 55aa 2a95
4a25 952c 64d9 c896 8d27 0c06 5936 e018
0810 d398 30b8 5934 d806 c290 8405 a113
200d e90e 1892 ac24 2b84 0448 1342 0787
30c6 103b 4002 d8b2 acb9 c657 d37b f5e6
e1ce d3df 6bef ef3b f73d 21d9 31dd 5a6f
2d51 f7da a537 ddfb 0fe7 3f67 9f6f d8df
fea2 bdfb ef4f 3078 0d46 6030 0283 11b8
0d47 201a 00e0 6df8 d407 b73c 1881 c108
6804 0600 3898 0883 1118 8cc0 6d3b 0203
00bc 6d1f fde0 c607 2330 1881 0100 0ee6
c060 0406 2370 db8e c000 006f db47 3fb8
f1c1 080c 4660 0080 8339 3018 81c1 08dc
```

+ 8950 4e47 0d0a 1a0a：这个是PNG图片的头，所有的PNG图片的头都是这一串编码，图片软件通过这串编码判定这个文件是不是PNG格式的图片。


+ 0000 000d：是iHDR数据块的长度，为13。

+ 4948 4452：是数据块的type,为IHDR，之后紧跟着是data。

+ 0000 02bc：是图片的宽度。

+ 0000 03a5：是高度。

#### 什么样的PNG图片更适合压缩
---

常规的png图片，颜色越单一，颜色值越少，压缩率就越大，


#### PNG的压缩

+ 预解析（Prediction）: 这个阶段就是对png图片进行一个预处理，处理后让它更方便后续的压缩，

+ 压缩（Compression）: 执行Deflate压缩，改算法结合了LZ77算法和Huffman算法对图片进行编码。



































